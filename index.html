<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¼í”Œìƒ˜ ë‚ ì”¨ ëŒ€ì‹œë³´ë“œ (2x2)</title>
    <style>
        /* --- í°íŠ¸ ë° ê¸°ë³¸ ì„¤ì • --- */
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Pretendard', sans-serif;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); /* ì‹œì›í•œ ë¸”ë£¨í†¤ */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #333;
        }

        h1 {
            color: white;
            font-size: 1.8rem;
            margin-bottom: 30px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            text-align: center;
        }

        /* --- 2x2 ê·¸ë¦¬ë“œ ì»¨í…Œì´ë„ˆ ì„¤ì • --- */
        .dashboard-container {
            display: grid;
            grid-template-columns: 1fr 1fr; /* ê°€ë¡œ 2ê°œ ê³ ì • */
            grid-template-rows: auto auto;  /* ì„¸ë¡œ 2ì¤„ */
            gap: 25px;                      /* ì¹´ë“œ ì‚¬ì´ ê°„ê²© */
            width: 100%;
            max-width: 800px;               /* ì „ì²´ í­ ì œí•œ (ë„ˆë¬´ ë„“ì–´ì§€ì§€ ì•Šê²Œ) */
        }

        /* --- ë‚ ì”¨ ì¹´ë“œ ë””ìì¸ --- */
        .weather-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.3s ease;
        }

        .weather-card:hover {
            transform: translateY(-5px);
        }

        /* --- ì¹´ë“œ ìƒë‹¨ ì„ íƒë°” --- */
        .card-header {
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        select {
            width: 100%;
            padding: 8px;
            border: none;
            background: transparent;
            font-size: 1.1rem;
            font-weight: 800;
            color: #333;
            cursor: pointer;
            outline: none;
            text-align: center;
            appearance: none; /* í™”ì‚´í‘œ ìˆ¨ê¹€ (ê¹”ë”í•˜ê²Œ) */
        }
        
        select:hover {
            color: #4facfe;
        }

        /* --- ë‚ ì”¨ ì•„ì´ì½˜ ë° ì˜¨ë„ --- */
        .weather-main {
            text-align: center;
            padding: 10px 0;
        }

        .icon { font-size: 3rem; margin-bottom: 5px; display: block; }
        .temp { font-size: 2.5rem; font-weight: 800; color: #2d3436; }
        .state-text { font-size: 1rem; color: #666; margin-top: 5px; font-weight: 600; }

        /* --- í•˜ë‹¨ ìƒì„¸ ì •ë³´ --- */
        .details {
            display: flex;
            justify-content: space-between;
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 16px;
            font-size: 0.85rem;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .d-label { color: #888; font-size: 0.75rem; margin-bottom: 2px; }
        .d-val { font-weight: 700; color: #444; }

        .loading-msg { text-align: center; color: #aaa; padding: 30px 0; }
        .error-msg { text-align: center; color: tomato; padding: 20px 0; font-size: 0.8rem; }

        /* --- ëª¨ë°”ì¼ ëŒ€ì‘ (í™”ë©´ì´ ì‘ì„ ë•Œë§Œ 1ì¤„ë¡œ) --- */
        @media (max-width: 600px) {
            .dashboard-container {
                grid-template-columns: 1fr; /* 1ì—´ë¡œ ë³€ê²½ */
            }
        }
    </style>
</head>
<body>

    <h1>ğŸŒ¤ï¸ ì „êµ­ ë‚ ì”¨ ëª¨ë‹ˆí„°</h1>

    <div class="dashboard-container">
        <div class="weather-card">
            <div class="card-header">
                <select id="select-1" onchange="updateCard(1)"></select>
            </div>
            <div id="content-1"></div>
        </div>

        <div class="weather-card">
            <div class="card-header">
                <select id="select-2" onchange="updateCard(2)"></select>
            </div>
            <div id="content-2"></div>
        </div>

        <div class="weather-card">
            <div class="card-header">
                <select id="select-3" onchange="updateCard(3)"></select>
            </div>
            <div id="content-3"></div>
        </div>

        <div class="weather-card">
            <div class="card-header">
                <select id="select-4" onchange="updateCard(4)"></select>
            </div>
            <div id="content-4"></div>
        </div>
    </div>

    <script>
        // --- API í‚¤ ë° ì§€ì—­ ë°ì´í„° ---
        const API_KEY = "a0e2c73cefbcf3f932d453d876e4fb86d7d348a7159b10c967be50940d913c73";

        const LOCATIONS = [
            { key: 'Goheung', name: 'ê³ í¥êµ° (ë‚¨ì–‘)', nx: 67, ny: 65 },
            { key: 'Dongjak', name: 'ì„œìš¸ ë™ì‘êµ¬', nx: 59, ny: 125 },
            { key: 'Damyang', name: 'ì „ë‚¨ ë‹´ì–‘êµ°', nx: 61, ny: 76 },
            { key: 'Jangheung', name: 'ì „ë‚¨ ì¥í¥êµ°', nx: 59, ny: 64 },
            { key: 'Yeosu', name: 'ì „ë‚¨ ì—¬ìˆ˜ì‹œ', nx: 73, ny: 66 },
            { key: 'Suncheon', name: 'ì „ë‚¨ ìˆœì²œì‹œ', nx: 68, ny: 68 },
            { key: 'Mokpo', name: 'ì „ë‚¨ ëª©í¬ì‹œ', nx: 58, ny: 66 },
            { key: 'Gwangju', name: 'ê´‘ì£¼ê´‘ì—­ì‹œ', nx: 58, ny: 74 },
            { key: 'Jeju', name: 'ì œì£¼íŠ¹ë³„ìì¹˜ë„', nx: 52, ny: 38 },
            { key: 'Busan', name: 'ë¶€ì‚°ê´‘ì—­ì‹œ', nx: 98, ny: 76 }
        ];

        // --- ì´ˆê¸° ì‹¤í–‰ ---
        window.onload = function() {
            // ìš”ì²­í•˜ì‹  4ê°œ ì§€ì—­ ê¸°ë³¸ê°’ ì„¤ì •
            initSelect('select-1', 'Goheung');   
            initSelect('select-2', 'Dongjak');   
            initSelect('select-3', 'Damyang');   
            initSelect('select-4', 'Jangheung'); 

            // ë°ì´í„° ë¡œë“œ
            for(let i=1; i<=4; i++) updateCard(i);
        };

        function initSelect(elementId, defaultKey) {
            const select = document.getElementById(elementId);
            LOCATIONS.forEach(loc => {
                const option = document.createElement('option');
                option.value = loc.key;
                option.text = loc.name; // ë“œë¡­ë‹¤ìš´ í…ìŠ¤íŠ¸
                if (loc.key === defaultKey) option.selected = true;
                select.appendChild(option);
            });
        }

        // --- ì‹œê°„ ê³„ì‚° (ë§¤ì‹œ 40ë¶„ ê¸°ì¤€) ---
        function getBaseTime() {
            const now = new Date();
            if (now.getMinutes() < 40) now.setHours(now.getHours() - 1);
            
            const y = now.getFullYear();
            const m = ('0' + (now.getMonth() + 1)).slice(-2);
            const d = ('0' + now.getDate()).slice(-2);
            const h = ('0' + now.getHours()).slice(-2);
            
            return { date: `${y}${m}${d}`, time: `${h}00` };
        }

        // --- ë°ì´í„° í˜¸ì¶œ ---
        async function updateCard(index) {
            const sel = document.getElementById(`select-${index}`).value;
            const loc = LOCATIONS.find(l => l.key === sel);
            const content = document.getElementById(`content-${index}`);
            const { date, time } = getBaseTime();

            content.innerHTML = `<div class="loading-msg">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>`;

            const url = `https://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getUltraSrtNcst?serviceKey=${API_KEY}&pageNo=1&numOfRows=10&dataType=JSON&base_date=${date}&base_time=${time}&nx=${loc.nx}&ny=${loc.ny}`;

            try {
                const res = await fetch(url);
                const json = await res.json();
                if (json.response.header.resultCode !== "00") throw new Error("API ì˜¤ë¥˜");

                const items = json.response.body.items.item;
                let data = { T1H: "-", REH: "-", RN1: "-", WSD: "-", PTY: "0" };

                items.forEach(item => {
                    if (data[item.category] !== undefined) data[item.category] = item.obsrValue;
                });

                renderCard(content, data);
            } catch (err) {
                console.error(err);
                content.innerHTML = `<div class="error-msg">ë¡œë“œ ì‹¤íŒ¨ (CORS í™•ì¸)</div>`;
            }
        }

        // --- UI ê·¸ë¦¬ê¸° ---
        function renderCard(target, data) {
            const state = getWeatherState(data.PTY);
            
            target.innerHTML = `
                <div class="weather-main">
                    <span class="icon">${state.icon}</span>
                    <div class="temp">${data.T1H}Â°</div>
                    <div class="state-text">${state.text}</div>
                </div>
                <div class="details">
                    <div class="detail-item">
                        <span class="d-label">ìŠµë„</span>
                        <span class="d-val">${data.REH}%</span>
                    </div>
                    <div class="detail-item">
                        <span class="d-label">ë°”ëŒ</span>
                        <span class="d-val">${data.WSD}m/s</span>
                    </div>
                    <div class="detail-item">
                        <span class="d-label">ê°•ìˆ˜</span>
                        <span class="d-val">${data.RN1}mm</span>
                    </div>
                </div>
            `;
        }

        function getWeatherState(code) {
            switch (code) {
                case "1": return { text: "ë¹„", icon: "ğŸŒ§ï¸" };
                case "2": return { text: "ë¹„/ëˆˆ", icon: "ğŸŒ¨ï¸" };
                case "3": return { text: "ëˆˆ", icon: "â„ï¸" };
                case "5": return { text: "ë¹—ë°©ìš¸", icon: "ğŸ’§" };
                case "6": return { text: "ì§„ëˆˆê¹¨ë¹„", icon: "ğŸŒ¨ï¸" };
                case "7": return { text: "ëˆˆë‚ ë¦¼", icon: "ğŸŒ¬ï¸" };
                case "0": default: return { text: "ë§‘ìŒ", icon: "â˜€ï¸" };
            }
        }
    </script>
</body>
</html>